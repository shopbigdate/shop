
<style type="text/css">
li{
		overflow:hidden;
		float:left;
		text-decoration:none;
		width:85px;
		text-align:center;
	}
	a{
		text-decoration: none;
	}
	.head{
		width:100%;
		padding-top:5px;
		height:25px;
		background-color: #E3E4E5;
	}
	.head_first{
		padding-left:100px;
		float:left;
	}
	.head_second{
		padding-left:600px;
		font-size: 12px;
		color:#F2F2F2;
	}
	.head_second_li{
		overflow:hidden;
		float:left;
		text-decoration:none;
		width:10px;
		text-align:center;
	}
	.head_second_li_1 ul{
		float:left;
		margin:0;
		padding:0;
		visibility:hidden;
		background-color: #FFFFFF;
	}
	.head_second_li_1:hover ul{
		visibility:visible;
	}
	.second{
		width:100%;
		height:75px;
		padding-top:25px;
	}
	.second_a_1{
		position: absolute;
		left:300px;
	}
	.second_a_2{
		position: absolute;
		left:450px;
		top:74px;
	}
	.second_input_1{
		position: absolute;
		left:950px;
		top:74px;
		width: 260px;
		height: 22px;
		font: 12px/150% tahoma,arial,Microsoft YaHei,Hiragino Sans GB,"\u5b8b\u4f53",sans-serif;
		border:2px solid #c91623;
	}
	.second_button_1{
		position: absolute;
		left:1215px;
		top:74px;
		width: 55px;
    	height: 28px;
		background-color: #c91623;
		border: none;
		color:white;
	}
	.body{
		height:600px;
		text-align: center;
	}
	.body_font_1{
		position: absolute;
		top:50%;
		left:40%;
	}
	.body_div_1{
		position:absolute;
		top:150px;
		left:300px;
		width:970px;;
		height:500px;
		
	}
	.body_div_1_font_1{
		float:left;
		line-height: 26px;
		font-weight: 700;
    	font-size: 16px;
		color: #E2231A;
	}
	.body_div_1_div_1{
		position:absolute;
		top:25px;
		width:100%;
		padding-top:10px;
		height:30px;
		background-color: #F3F3F3;
		border: 1px solid #e9e9e9;
	}
	.body_div_1_div_1_input_1{
		float:left;
				position: absolute;
		font: 12px/150% tahoma,arial,Microsoft YaHei,Hiragino Sans GB,"\u5b8b\u4f53",sans-serif;
		color: #666;
		
		
		
	}
	.body_div_1_div_1_font_1{
		position: absolute;
		left:25px;
		font: 12px/150% tahoma,arial,Microsoft YaHei,Hiragino Sans GB,"\u5b8b\u4f53",sans-serif;
		color: #666;
	}
	.body_div_1_div_1_font_2{
		position: absolute;
		left:200px;
		font: 12px/150% tahoma,arial,Microsoft YaHei,Hiragino Sans GB,"\u5b8b\u4f53",sans-serif;
		color: #666;
	}
	.body_div_1_div_1_font_3{
		position: absolute;
		left:400px;
		font: 12px/150% tahoma,arial,Microsoft YaHei,Hiragino Sans GB,"\u5b8b\u4f53",sans-serif;
		color: #666;
	}
	.body_div_1_div_1_font_4{
		position: absolute;
		left:600px;
		font: 12px/150% tahoma,arial,Microsoft YaHei,Hiragino Sans GB,"\u5b8b\u4f53",sans-serif;
		color: #666;
	}
	.body_div_1_div_1_font_5{
		position: absolute;
		left:750px;
		font: 12px/150% tahoma,arial,Microsoft YaHei,Hiragino Sans GB,"\u5b8b\u4f53",sans-serif;
		color: #666;
	}
	.body_div_1_div_1_font_6{
		position: absolute;
		left:860px;
		font: 12px/150% tahoma,arial,Microsoft YaHei,Hiragino Sans GB,"\u5b8b\u4f53",sans-serif;
		color: #666;
	}
	.body_div_1_div_2{
		position:absolute;
		top:80px;
		padding-top:10px;
		width:970px;
		height:90px;
	}
	.body_div_1_img_1{
		margin-left:10px;
		float:left;
		width:80px;
		height:80px;
	}
	.body_div_1_div_2_div_1{
		float:left;
		width:200px;
		margin-left:200px;
		height:80px;
		line-height: 20px;
		font: 12px/150% tahoma,arial,Microsoft YaHei,Hiragino Sans GB,"\u5b8b\u4f53",sans-serif;
		text-align: left;
	}
	.body_div_1_div_2_div_1_a_1:hover{
		color:red;
	}
	.body_div_1_div_2_div_2{
		float:left;
		width:120px;
		margin-left:20px;
		height:80px;
		line-height: 20px;
		font: 12px/150% tahoma,arial,Microsoft YaHei,Hiragino Sans GB,"\u5b8b\u4f53",sans-serif;
		text-align: left;
	}
	.body_div_1_div_2_div_3{
		float:left;
		width:100px;
		margin-left:40px;
		height:80px;
		line-height: 20px;
		font: 12px/150% tahoma,arial,Microsoft YaHei,Hiragino Sans GB,"\u5b8b\u4f53",sans-serif;
	}
	.body_div_1_div_2_div_4{
		float:left;
		width:100px;
		margin-left:30px;
		height:80px;
		line-height: 20px;
		font: 12px/150% tahoma,arial,Microsoft YaHei,Hiragino Sans GB,"\u5b8b\u4f53",sans-serif;
	}
	.body_div_1_div_2_div_4_input_1{
    	border: 1px solid #cacbcb;
    	color: #666;
	}
	.body_div_1_div_2_div_4_input_2{
		border: 1px solid #cacbcb;
   	 	width: 40px;
    	height: 15px;
    	line-height: 18px;
    	text-align: center;
    	margin: 0;
    	font-size: 12px;
    	font-family: verdana;
    	color: #333;
	}
	.body_div_1_div_2_div_4_input_3{
    	border: 1px solid #cacbcb;
    	color: #666;
	}
	.body_div_1_div_2_div_5{
		float:left;
		width:100px;
		margin-left:30px;
		height:80px;
		line-height: 20px;
		font: 12px/150% tahoma,arial,Microsoft YaHei,Hiragino Sans GB,"\u5b8b\u4f53",sans-serif;
	}
	.body_div_1_div_2_div_6{
		float:left;
		width:80px;
		margin-left:20px;
		height:80px;
		line-height: 20px;
		font: 12px/150% tahoma,arial,Microsoft YaHei,Hiragino Sans GB,"\u5b8b\u4f53",sans-serif;
		text-align: left;
	}
	.body_div_2{
		position: absolute;
		top:340px;
		left:300px;
		padding-top:10px;
		width:970px;
		height:42px;
		text-align: left;
		border: 1px solid #e9e9e9;
	}
	.body_div_2_input_1{
		margin-top:11px;
		vertical-align: middle;
	}
	.body_div_2_font_1{
		position:absolute;
		top:18px;
		left:20px;
		font: 12px/150% tahoma,arial,Microsoft YaHei,Hiragino Sans GB,"\u5b8b\u4f53",sans-serif;
	}
	.body_div_2_a_1{
		position:absolute;
		top:18px;
		left:70px;
		line-height: 50px;
		font: 12px/150% tahoma,arial,Microsoft YaHei,Hiragino Sans GB,"\u5b8b\u4f53",sans-serif;
	}
	.body_div_2_a_2{
		position:absolute;
		top:18px;
		left:170px;
		line-height: 50px;
		font: 12px/150% tahoma,arial,Microsoft YaHei,Hiragino Sans GB,"\u5b8b\u4f53",sans-serif;
	}
	.body_div_2_a_3{
		position:absolute;
		top:18px;
		left:260px;
		line-height: 50px;
		font: 12px/150% tahoma,arial,Microsoft YaHei,Hiragino Sans GB,"\u5b8b\u4f53",sans-serif;
	}
	.body_div_2_font_2{
		color: #999;
		position:absolute;
		top:10px;
		left:650px;
		font: 12px/150% tahoma,arial,Microsoft YaHei,Hiragino Sans GB,"\u5b8b\u4f53",sans-serif;
	}
	.body_div_2_font_3{
		color: #999;
		position:absolute;
		top:10px;
		left:750px;
		font: 12px/150% tahoma,arial,Microsoft YaHei,Hiragino Sans GB,"\u5b8b\u4f53",sans-serif;
	}
	.body_div_2_font_4{
		font-size: 16px;
    	color: #E2231A;
    	font-weight: 700;
    	position:absolute;
		top:10px;
		left:790px;
	}
	.body_div_2_a_4{
		position: absolute;
		top:0px;
		left:875px;
   	 	width: 95px;
    	height: 55px;
    	background-image: url(../../static/images/cart-submit-btn-2018.png);
	}
	.third{
		position:absolute;
		top:650px;
		width:100%;
		height:200px;
		text-align: center;
	}
	.third_hr_1{
		width:70%;
	}
	.third_ul_1{
		position: absolute;
		color: #999;
		left:50px;
		font-size: 12px;
	}
	.third_font_1{
		position:absolute;
		left:350px;
		top:100px;
		font-size: 12px;
		color: #999;
	}
</style>

<template>
	<div>
	<div class="head">
		<div class="head_first">
			<a href="">ğŸ äº¬ä¸œé¦–é¡µ</a>
		</div>
		<div class="head_second">
			<li><a href="login.html">æ‚¨å¥½ï¼Œè¯·ç™»å½•</a></li>
			<li class="head_second_li">ä¸¨</li>
			<li><a href="register.html">å…è´¹æ³¨å†Œ</a></li>
			<li class="head_second_li">ä¸¨</li>
			<li><a href="order.html">æˆ‘çš„è®¢å•</a></li>
			<li class="head_second_li">ä¸¨</li>
			<li class="head_second_li_1">
				<a href="">æˆ‘çš„äº¬ä¸œ  âˆ¨</a>
				<ul>
					<li><a href="">å¾…å¤„ç†è®¢å•</a></li>
					<li><a href="">è¿”ä¿®é€€è¿˜è´§</a></li>
					<li><a href="">é™ä»·å•†å“</a></li>
					<li><a href="">æ¶ˆæ¯</a></li>
					<li><a href="">æˆ‘çš„é—®ç­”</a></li>
					<li><a href="">æˆ‘çš„å¸®åŠ©</a></li>
				</ul>
			</li>
			<li class="head_second_li">ä¸¨</li>
			<li><a href="">äº¬ä¸œä¼šå‘˜</a></li>
			<li class="head_second_li">ä¸¨</li>
			<li class="head_second_li_1">
				<a href="">ä¼ä¸šé‡‡è´­  âˆ¨</a>
				<ul>
					<li><a href="">ä¼ä¸šè´­</a></li>
					<li><a href="">å•†ç”¨åœºæ™¯é¦†</a></li>
					<li><a href="">å·¥ä¸šå“</a></li>
					<li><a href="">ç¤¼å“å¡</a></li>
				</ul>
			</li>
			<li class="head_second_li">ä¸¨</li>
			<li class="head_second_li_1">
				<a href="">å®¢æœæœåŠ¡  âˆ¨</a>
				<ul>
					<li><a href="">----</a></li>
					<li><a href="">----</a></li>
					<li><a href="">----</a></li>
					<li><a href="">----</a></li>
				</ul>
			</li>
			<li class="head_second_li">ä¸¨</li>
			<li class="head_second_li_1">
				<a href="">ç½‘ç«™å¯¼èˆª  âˆ¨</a>
				<ul>
					<li><a href="">----</a></li>
					<li><a href="">----</a></li>
					<li><a href="">----</a></li>
					<li><a href="">----</a></li>
				</ul>
			</li>
			<li class="head_second_li">ä¸¨</li>
			<li><a href="">æ‰‹æœºäº¬ä¸œ</a></li>
		</div>
	</div>
	<div class="second">
		<a href="" class="second_a_1"><img alt="" src="../../static/images/jdlogo-201708-@1x.png"></a>
		<a href="" class="second_a_2"><img alt="" src="../../static/images/cart-icon.png"></a>
		<input type="text" class="second_input_1">
		<button class="second_button_1"><strong>æœç´¢</strong></button>
	</div>
	<div class="body">
						<div class="body_div_1">
								<font class="body_div_1_font_1">å…¨éƒ¨å•†å“</font>
								<div>
									<div class="body_div_1_div_1">
                   <table>
					<tr>
						<td class="body_div_1_div_1_font_1">
							<input type="checkbox" v-model="checkAll" @click="selectAll" class="body_div_1_div_1_input_1"/>
						</td>
						<td class="body_div_1_div_1_font_2">
							å•†å“åç§°
						</td>
						<td class="body_div_1_div_1_font_3">
							å•†å“ä»·æ ¼
						</td>
						<td class="body_div_1_div_1_font_4">
							å•†å“æ•°é‡
						</td>
						<td class="body_div_1_div_1_font_5">
							å•†å“æ€»é¢
						</td>
						<td class="body_div_1_div_1_font_6">
							æ“ä½œ
						</td>
					</tr>
					
					<div class="body_div_1_div_2">
					<tr v-for="(item,index) in infoList">
						
						<td>
							<input 
								type="checkbox" 
								:value="item.shopping_car_id"
								v-model="checkItem"
								@change="selectOne(index)"
								class="body_div_1_div_1_input_1"
							>
						</td>
						<td class="body_div_1_div_2_div_1"><router-link :to="{path:'/search',query: {goods_id:item.goods_id}}">{{item.goods_name}}</router-link></td>
						<td class="body_div_1_div_2_div_2">{{item.goods_price}}</td>
						
						
						<td class="body_div_1_div_2_div_3">
							<button class="body_div_1_div_2_div_4_input_1" @click="reduce(index)">-</button>
							<input class="body_div_1_div_2_div_4_input_2" type="text" v-model="item.goods_number" />
							<button class="body_div_1_div_2_div_4_input_3"  @click="add(index)">+</button>
						</td>
						
						<td class="body_div_1_div_2_div_5">
							{{item.goods_price*item.goods_number}}
						</td>
						<td class="body_div_1_div_2_div_6">
							<button class="btn btn-danger" @click="del(index)">åˆ é™¤</button>
						</td>
					</tr>
				</div>
				</table>

				
				
			</div>
			
					        
</div>
							</div>
	</div>
	
	<div class="third">
		<div>
		        	<p class="text-right">
					é‡‘é¢æ€»è®¡:{{sum}}
				</p>
				<p class="text-right">
					å•†å“æ•°é‡:{{count}}
				</p>
				<input class="body_div_2_a_4" type="button" value="" @click="Settlement"></input>	
		        </div>
		<hr class="third_hr_1">
		<ul class="third_ul_1">
			<li><a href="">å…³äºæˆ‘ä»¬</a></li>
			<li><a href="">è”ç³»æˆ‘ä»¬</a></li>
			<li><a href="">äººæ‰æ‹›è˜</a></li>
			<li><a href="">å•†å®¶å…¥é©»</a></li>
			<li><a href="">å¹¿å‘Šæ‹›ç§Ÿ</a></li>
			<li><a href="">å¹¿å‘ŠæœåŠ¡</a></li>
			<li><a href="">æ‰‹æœºäº¬ä¸œ</a></li>
			<li><a href="">å‹æƒ…é“¾æ¥</a></li>
			<li><a href="">é”€å”®è”ç›Ÿ</a></li>
			<li><a href="">äº¬ä¸œç¤¾åŒº</a></li>
			<li><a href="">äº¬ä¸œå…¬ç›Š</a></li>
			<li style="border:none;"><a href="">English Site</a></li>
		</ul>
		<font class="third_font_1">CopyrightÂ©2004-2019  äº¬ä¸œJD.com ç‰ˆæƒæ‰€æœ‰</font>
	</div>
	</div>
</template>


<script>
	export default {
    name: 'ShoppingCar',
    data() {
      return {
      		input:{
      			orderDetail:[
//						{shopping_car_id:1,goods_name:"å†°æ·‡å‡Œ",goods_price:10.0,goods_number:3,isbuy:false}
					],
				order_sum:0
      		}, 
      		        infoList:[],
					checkItem:[],
					checkAll:false

      }
    },
    mounted:function(){
    	this.searchshoppingcar();
    },
    methods: {

   	
    	del:function(index){
    		    var self = this
				let formData = JSON.stringify({
					goods_id:this.infoList[index].goods_id
				});
				var url = "http://localhost:8888/ShoppingCarControllor/deletegoods_id";
				self.$axios.post(url, formData, {
					headers: {
						'Content-Type': 'application/json;charset=UTF-8'
					}
				}).then(function(response) {
					console.log(response);
				});
//				self.searchshoppingcar();
    },
    	Settlement(){
		    var self = this
				let formData = JSON.stringify(self.input);
				var url = "http://localhost:8888/aa/liusuan2";
				self.$axios.post(url, formData, {
					headers: {
						'Content-Type': 'application/json;charset=UTF-8'
					}
				}).then(function(response) {
					console.log(response);
				})

    	},
//  	      searchshoppingcar: function () {
//    	var self = this
//    	//http://localhost:8888/ShoppingCarControllor/searchshoppingcar
//      self.$axios.get('http://localhost:8888/ShoppingCarControllor/getAllShoppingCarInfo')
//        .then(response => {self.infoList = response.data})
//        .catch(function (error) { // è¯·æ±‚å¤±è´¥å¤„ç†
//          console.log(error);
//        });
//    },
      searchshoppingcar: function () {  
      	var self = this;
        self.$axios.post('http://localhost:8888/ShoppingCarControllor/getAllShoppingCarInfo')
          .then(response => {self.infoList = response.data})
          .catch(function (error) { // è¯·æ±‚å¤±è´¥å¤„ç†
            console.log(error);
          }); 

      },
                  add:function(index){
						this.infoList[index].goods_number++
						 
					},
					reduce:function(index){
						if(this.infoList[index].goods_number<=0){
							this.infoList[index].goods_number = 0
						}else {
							this.infoList[index].goods_number--
						}
						
					},
					selectOne(index){
						if(this.checkItem.length == this.infoList.length){
							this.checkAll = true
						}else {
							this.checkAll = false
						}
						if(this.infoList[index].isbuy){
							this.infoList[index].isbuy = false
							this.input.orderDetail.splice(index, 1);
						}else{
							this.infoList[index].isbuy = true
							this.input.orderDetail.push(this.infoList[index])
						}
						
					},
					selectAll(){
						this.checkItem = []
						if(!this.checkAll){
							for (var i=0;i<this.infoList.length;i++) {
								this.checkItem.push(this.infoList[i].shopping_car_id)
								this.input.orderDetail.push(this.infoList[i])
								this.infoList[i].isbuy = true
							}
						}else {
							this.checkItem = []
							this.checkAll = false
							for (var i=0;i<this.infoList.length;i++) {
								this.input.orderDetail.splice(i, 1);
								this.infoList[i].isbuy = false
							}
						}
						
					}
    },
    
    
    computed:{
					sum(){
						var total = 0
						for (var i=0;i<this.infoList.length;i++) {
							if(this.infoList[i].isbuy){
								total+=parseFloat(this.infoList[i].goods_price)*parseFloat(this.infoList[i].goods_number)
							}
						}
						this.input.order_sum = total
						//alert(this.input.order_sum)
						return total	
					},
					count:function(){
						var total = 0
						for (var i=0;i<this.infoList.length;i++) {
							if(this.infoList[i].isbuy){
								total+=parseInt(this.infoList[i].goods_number)
							}
							
						}
						return total
					}
				}
  }
	
</script>